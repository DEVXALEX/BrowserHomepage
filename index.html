<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23f5f5f5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><path d='M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'/><polyline points='9 22 9 12 15 12 15 22'/></svg>">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="css/main.css">

</head>

<body>
    <div id="global-background"></div>

    <nav id="top-navbar">
        <div class="nav-logo">
            <i class="fa-solid fa-home"></i>
        </div>
        <ul class="nav-links">
            <li data-action="home">Home</li>
            <li data-action="calendar">Calendar</li> <!-- Added -->
            <li data-action="todo">Tasks</li>
            <li data-action="notes">Notes</li>
            <li data-action="bg">Gallery</li>
            <li data-action="ambient">Sounds</li>
            <li data-action="bookmarks">Bookmarks</li>
            <li data-action="passwords"><i class="fa-solid fa-lock"
                    style="font-size: 0.8rem; margin-right: 5px;"></i>Passwords</li>
            <li data-action="settings">Settings</li>
        </ul>
        <div class="nav-extra">
            <!-- Space for future additions -->
        </div>
    </nav>

    <!-- Calendar Modal (Split View) -->
    <div id="calendar-modal" class="modal-backdrop-fullscreen">
        <button id="close-calendar-btn" class="close-btn-floating">×</button>
        <div class="calendar-split-view">
            <!-- Left Side: Calendar -->
            <div class="calendar-panel">
                <div class="calendar-header">
                    <button id="prev-month-btn"><i class="fa-solid fa-chevron-left"></i></button>
                    <h2 id="calendar-month-year"></h2>
                    <button id="next-month-btn"><i class="fa-solid fa-chevron-right"></i></button>
                    <button id="calendar-view-toggle" title="Toggle Full Screen"
                        style="margin-left: 1rem; border-radius: 8px; width: auto; padding: 0 1rem;">
                        <i class="fa-solid fa-expand"></i>
                    </button>
                </div>
                <div class="calendar-grid-header">
                    <span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span><span>Sun</span>
                </div>
                <div id="calendar-days" class="calendar-grid"></div>
            </div>

            <!-- Right Side: Date Notes -->
            <div class="date-notes-panel">
                <div class="date-notes-header">
                    <div class="selected-date-display">
                        <span id="selected-date-day"></span>
                        <span id="selected-date-full">Select a date</span>
                    </div>
                </div>
                <div class="date-notes-list-container">
                    <ul id="date-notes-list">
                        <li class="empty-note-state">No notes for this day.</li>
                    </ul>
                </div>
                <form id="date-note-form">
                    <input type="text" id="date-note-input" placeholder="Add a note..." autocomplete="off">
                    <button type="submit"><i class="fa-solid fa-plus"></i></button>
                </form>
            </div>
        </div>
    </div>

    <div id="section-modal" class="modal-backdrop">
        <form class="modal-form" id="section-form">
            <h3>Add New Section</h3>
            <div class="form-group">
                <label for="section-title-input">Section Title</label>
                <input type="text" id="section-title-input" required autocomplete="off">
            </div>
            <div class="form-actions">
                <button type="button" class="form-btn-cancel" id="cancel-section-form">Cancel</button>
                <button type="submit" class="form-btn-save">Save</button>
            </div>
        </form>
    </div>

    <div id="link-modal" class="modal-backdrop">
        <form class="modal-form" id="link-form">
            <h3>Add New Link</h3>
            <input type="hidden" id="link-category-id">
            <div class="form-group">
                <label for="link-name-input">Link Name</label>
                <input type="text" id="link-name-input" placeholder="e.g., Google" autocomplete="off">
            </div>
            <div class="form-group">
                <label for="link-url-input">Link URL</label>
                <input type="text" id="link-url-input" placeholder="https://google.com" required autocomplete="off">
            </div>
            <div class="form-group">
                <label for="link-icon-input">Font Awesome Icon (Optional)</label>
                <input type="text" id="link-icon-input" placeholder="fa-brands fa-google" autocomplete="off">
                <p class="form-help-text">
                    Leave empty to auto-fetch icon.
                    Or, find one <a href="https://fontawesome.com/search?m=free&s=brands,solid"
                        target="_blank">here</a>.
                </p>
            </div>
            <div class="form-actions">
                <button type="button" class="form-btn-cancel" id="cancel-link-form">Cancel</button>
                <button type="submit" class="form-btn-save">Save</button>
            </div>
        </form>
    </div>

    <div id="bookmarks-modal" class="modal-backdrop">
        <div class="bookmarks-container">
            <div class="bookmarks-header">
                <h3><i class="fa-solid fa-bookmark"></i> Temporary Bookmarks</h3>
                <button id="close-bookmarks-modal" class="close-btn">×</button>
            </div>
            <div class="bookmarks-content">
                <ul id="bookmarks-list"></ul>
            </div>
            <form class="bookmarks-form" id="bookmarks-form">
                <input type="text" id="bookmark-name-input" placeholder="Bookmark Name" required autocomplete="off">
                <input type="text" id="bookmark-url-input" placeholder="https://..." required autocomplete="off">
                <button type="submit" class="form-btn-save"><i class="fa-solid fa-plus"></i> Add</button>
            </form>
        </div>
    </div>

    <div id="notes-modal" class="modal-backdrop">
        <div class="notes-app-container">
            <div class="notes-sidebar">
                <button class="notes-btn-new" id="notes-add-btn">
                    <i class="fa-solid fa-plus"></i> New Note
                </button>
                <ul id="notes-list"></ul>
            </div>
            <div class="notes-editor">
                <button class="close-btn" id="notes-close-btn">×</button>
                <div id="note-editor-container" class="hidden">
                    <input type="text" id="note-title-input" placeholder="Note Title">
                    <textarea id="note-content-textarea" placeholder="Start writing..."></textarea>
                    <div class="notes-editor-actions">
                        <button class="notes-btn-save" id="note-save-btn"><i class="fa-solid fa-save"></i> Save</button>
                        <button class="notes-btn-discard" id="note-discard-btn"><i class="fa-solid fa-times"></i>
                            Discard</button>
                        <button class="notes-btn-delete" id="note-delete-btn"><i class="fa-solid fa-trash"></i>
                            Delete</button>
                    </div>
                </div>
                <div id="note-editor-placeholder">
                    <i class="fa-solid fa-note-sticky"></i>
                    <p>Select a note from the list, or create a new one.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="todo-modal" class="modal-backdrop">
        <div class="todo-container">
            <div class="todo-header">
                <h3><i class="fa-solid fa-list-check"></i> To-Do List</h3>
                <button id="close-todo-modal" class="close-btn">×</button>
            </div>
            <div class="todo-content">
                <ul id="todo-list"></ul>
            </div>
            <form class="todo-form" id="todo-form">
                <input type="text" id="todo-input" placeholder="New task..." required autocomplete="off">
                <button type="submit" class="form-btn-save"><i class="fa-solid fa-plus"></i> Add</button>
            </form>
        </div>
    </div>

    <div id="bg-modal" class="modal-backdrop">
        <div class="bg-modal-container">
            <div class="bg-modal-header">
                <div class="bg-header-top">
                    <h3><i class="fa-solid fa-image"></i> Background Settings</h3>
                    <button id="close-bg-modal" class="close-btn">×</button>
                </div>

                <!-- Tab Navigation -->
                <div class="bg-tabs">
                    <button class="bg-tab active" data-tab="auto">
                        <i class="fa-solid fa-wand-magic-sparkles"></i> Auto Fetch
                    </button>
                    <button class="bg-tab" data-tab="custom">
                        <i class="fa-solid fa-link"></i> Custom URL
                    </button>
                </div>
            </div>

            <!-- Auto Fetch Tab -->
            <div class="bg-tab-content active" id="auto-tab">
                <!-- Category Selection -->
                <div class="bg-section">
                    <h4>Category</h4>
                    <div class="bg-category-grid">
                        <button class="category-btn active" data-category="random">
                            <i class="fa-solid fa-shuffle"></i>
                            <span>Random</span>
                        </button>
                        <button class="category-btn" data-category="nature">
                            <i class="fa-solid fa-tree"></i>
                            <span>Nature</span>
                        </button>
                        <button class="category-btn" data-category="minimal">
                            <i class="fa-solid fa-cube"></i>
                            <span>Minimal</span>
                        </button>
                        <button class="category-btn" data-category="urban">
                            <i class="fa-solid fa-city"></i>
                            <span>Urban</span>
                        </button>
                        <button class="category-btn" data-category="space">
                            <i class="fa-solid fa-moon"></i>
                            <span>Space</span>
                        </button>
                        <button class="category-btn" data-category="abstract">
                            <i class="fa-solid fa-palette"></i>
                            <span>Abstract</span>
                        </button>
                    </div>
                    <button id="fetch-random-btn" class="form-btn-save" style="width: 100%; margin-top: 0.5rem;">
                        <i class="fa-solid fa-arrows-rotate"></i> Get Random Image
                    </button>
                </div>

                <!-- Time-Based Toggle -->
                <div class="bg-section">
                    <label class="bg-toggle-label">
                        <input type="checkbox" id="time-based-toggle">
                        <span>Time-Based Auto-Change</span>
                        <small>Automatically change background based on time of day</small>
                    </label>
                </div>

                <!-- Adjustments -->
                <div class="bg-section">
                    <h4>Adjustments</h4>
                    <div class="slider-group">
                        <label>
                            <span>Blur</span>
                            <span id="blur-value">0px</span>
                        </label>
                        <input type="range" id="blur-slider" min="0" max="20" value="0" step="1">
                    </div>
                    <div class="slider-group">
                        <label>
                            <span>Brightness</span>
                            <span id="brightness-value">100%</span>
                        </label>
                        <input type="range" id="brightness-slider" min="0" max="200" value="100" step="5">
                    </div>
                </div>

                <!-- Filters -->
                <div class="bg-section">
                    <h4>Filters</h4>
                    <div class="filter-grid">
                        <button class="filter-btn active" data-filter="none">None</button>
                        <button class="filter-btn" data-filter="grayscale">Grayscale</button>
                        <button class="filter-btn" data-filter="sepia">Sepia</button>
                        <button class="filter-btn" data-filter="vibrant">Vibrant</button>
                        <button class="filter-btn" data-filter="dark">Dark</button>
                    </div>
                </div>
            </div>

            <!-- Custom URL Tab -->
            <div class="bg-tab-content" id="custom-tab">
                <div class="bg-section">
                    <label for="bg-url-input">Image URL</label>
                    <input type="text" id="bg-url-input" placeholder="https://images.unsplash.com/..."
                        autocomplete="off">
                    <p class="form-help-text">Paste a direct link to an image. Leave empty to reset.</p>
                    <button id="apply-custom-btn" class="form-btn-save" style="width: 100%; margin-top: 0.5rem;">
                        Apply Image
                    </button>
                </div>

                <!-- Same Adjustments & Filters for Custom -->
                <div class="bg-section">
                    <h4>Adjustments</h4>
                    <div class="slider-group">
                        <label>
                            <span>Blur</span>
                            <span id="blur-value-custom">0px</span>
                        </label>
                        <input type="range" id="blur-slider-custom" min="0" max="20" value="0" step="1">
                    </div>
                    <div class="slider-group">
                        <label>
                            <span>Brightness</span>
                            <span id="brightness-value-custom">100%</span>
                        </label>
                        <input type="range" id="brightness-slider-custom" min="0" max="200" value="100" step="5">
                    </div>
                </div>

                <div class="bg-section">
                    <h4>Filters</h4>
                    <div class="filter-grid">
                        <button class="filter-btn-custom active" data-filter="none">None</button>
                        <button class="filter-btn-custom" data-filter="grayscale">Grayscale</button>
                        <button class="filter-btn-custom" data-filter="sepia">Sepia</button>
                        <button class="filter-btn-custom" data-filter="vibrant">Vibrant</button>
                        <button class="filter-btn-custom" data-filter="dark">Dark</button>
                    </div>
                </div>
            </div>

            <!-- Favorites Section (Visible in both tabs) -->
            <div class="bg-section favorites-section">
                <div class="favorites-header">
                    <h4><i class="fa-solid fa-star"></i> Favorites</h4>
                    <button id="add-to-favorites-btn" class="icon-btn" title="Add current background to favorites">
                        <i class="fa-solid fa-heart"></i>
                    </button>
                </div>
                <div id="favorites-grid" class="favorites-grid">
                    <p class="empty-favorites">No favorites yet. Click the heart to save images!</p>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="bg-modal-actions">
                <button type="button" class="form-btn-cancel" id="cancel-bg-form">Close</button>
                <button type="button" class="form-btn-save" id="clear-bg-btn">
                    <i class="fa-solid fa-eraser"></i> Clear Background
                </button>
            </div>
        </div>
    </div>


    <!-- Ambient Sounds Modal -->
    <div id="ambient-modal" class="modal-backdrop">
        <div class="modal-form" id="ambient-container">
            <h3><i class="fa-solid fa-headphones"></i> Ambient Sounds</h3>
            <div class="ambient-controls">
                <div class="now-playing">
                    <span id="current-sound-name">Select a sound</span>
                    <div class="visualizer">
                        <div class="bar"></div>
                        <div class="bar"></div>
                        <div class="bar"></div>
                    </div>
                </div>
                <div class="playback-controls">
                    <button id="ambient-play-pause"><i class="fa-solid fa-play"></i></button>
                    <input type="range" id="ambient-volume" min="0" max="1" step="0.1" value="0.5">
                </div>
            </div>
            <div class="sound-grid">
                <button class="sound-btn" data-sound="rain"><i class="fa-solid fa-cloud-rain"></i> Rain</button>
                <button class="sound-btn" data-sound="forest"><i class="fa-solid fa-tree"></i> Forest</button>
                <button class="sound-btn" data-sound="ocean"><i class="fa-solid fa-water"></i> Ocean</button>
                <button class="sound-btn" data-sound="cafe"><i class="fa-solid fa-mug-hot"></i> Cafe</button>
                <button class="sound-btn" data-sound="fire"><i class="fa-solid fa-fire"></i> Fire</button>
                <button class="sound-btn" data-sound="night"><i class="fa-solid fa-moon"></i> Night</button>
                <button class="sound-btn" data-sound="wind"><i class="fa-solid fa-wind"></i> Wind</button>
                <button class="sound-btn" data-sound="white_noise"><i class="fa-solid fa-wave-square"></i> White
                    Noise</button>
            </div>
            <div class="form-actions">
                <button type="button" class="form-btn-cancel" id="close-ambient-modal">Close</button>
            </div>
        </div>
    </div>

    <!-- Calculator Modal -->
    <div id="calculator-modal" class="modal-backdrop">
        <div class="calculator-container">
            <div class="calc-header">
                <h3><i class="fa-solid fa-calculator"></i> Calculator</h3>
                <button id="close-calculator-modal" class="close-btn">×</button>
            </div>
            <div class="calc-display">
                <div id="calc-history"></div>
                <div id="calc-result">0</div>
            </div>
            <div class="calc-keypad">
                <button class="calc-btn op-btn" data-action="clear">C</button>
                <button class="calc-btn op-btn" data-action="backspace"><i class="fa-solid fa-delete-left"></i></button>
                <button class="calc-btn op-btn" data-action="percent">%</button>
                <button class="calc-btn op-btn" data-action="operator" data-value="/">÷</button>

                <button class="calc-btn num-btn" data-value="7">7</button>
                <button class="calc-btn num-btn" data-value="8">8</button>
                <button class="calc-btn num-btn" data-value="9">9</button>
                <button class="calc-btn op-btn" data-action="operator" data-value="*">×</button>

                <button class="calc-btn num-btn" data-value="4">4</button>
                <button class="calc-btn num-btn" data-value="5">5</button>
                <button class="calc-btn num-btn" data-value="6">6</button>
                <button class="calc-btn op-btn" data-action="operator" data-value="-">−</button>

                <button class="calc-btn num-btn" data-value="1">1</button>
                <button class="calc-btn num-btn" data-value="2">2</button>
                <button class="calc-btn num-btn" data-value="3">3</button>
                <button class="calc-btn op-btn" data-action="operator" data-value="+">+</button>

                <button class="calc-btn num-btn zero-btn" data-value="0">0</button>
                <button class="calc-btn num-btn" data-value=".">.</button>
                <button class="calc-btn eq-btn" data-action="calculate">=</button>
            </div>
        </div>
    </div>


    <div id="main-content">
        <main>
            <header>
                <div id="date-display"></div>

                <div id="time"></div>
                <p id="quote"></p>
            </header>

            <section class="search-container">
                <form id="search-form" action="https://www.google.com/search" method="get" target="_blank">
                    <input type="text" id="search-input" name="q" placeholder="Search Google..." autocomplete="off">
                    <button type="submit" id="search-button">Search</button>
                </form>

                <div class="search-toggle-container">
                    <span id="search-mode-icon"><i class="fa-brands fa-google"></i></span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="search-toggle-switch">
                        <span class="slider"></span>
                    </label>
                    <span id="copy-feedback">Copied to clipboard!</span>
                </div>
            </section>

            <nav class="links-container" id="links-container">
            </nav>

            <div id="add-section-btn-container">
                <button id="add-section-btn">
                    <i class="fa-solid fa-plus"></i> Add Section
                </button>
            </div>
        </main>
    </div>

    <button id="sidebar-toggle" title="Toggle Sidebar">
        <i class="fa-solid fa-chevron-right"></i>
    </button>

    <aside id="widget-sidebar">
        <button class="widget-btn" id="todo-toggle-btn" title="To-Do List">
            <i class="fa-solid fa-list-check"></i>
        </button>
        <button class="widget-btn" id="notes-toggle-btn" title="Notes">
            <i class="fa-solid fa-note-sticky"></i>
        </button>
        <button class="widget-btn" id="bookmarks-toggle" title="Temporary Bookmarks">
            <i class="fa-solid fa-bookmark"></i>
        </button>

        <button class="widget-btn" id="ambient-toggle-btn" title="Ambient Sounds">
            <i class="fa-solid fa-headphones"></i>
        </button>
        <button class="widget-btn" id="calculator-toggle-btn" title="Calculator">
            <i class="fa-solid fa-calculator"></i>
        </button>
        <button class="widget-btn" id="bg-toggle-btn" title="Change Background">
            <i class="fa-solid fa-image"></i>
        </button>

        <button class="widget-btn" id="icon-toggle" title="Toggle Icon-Only Mode">
            <i class="fa-solid fa-table-cells"></i>
        </button>
        <button class="widget-btn" id="edit-toggle" title="Toggle Edit Mode">
            <i class="fa-solid fa-pencil"></i>
        </button>
        <button class="widget-btn" id="settings-toggle-btn" title="Settings & Data">
            <i class="fa-solid fa-cog"></i>
        </button>
    </aside>

    <div id="settings-modal" class="modal-backdrop">
        <div class="modal-form" id="settings-form-container">
            <h3><i class="fa-solid fa-cog"></i> Settings & Data</h3>

            <div class="settings-section">
                <h4><i class="fa-solid fa-hard-drive"></i> Manual Backup</h4>
                <p class="settings-desc">Export data to a file or restore from a backup.</p>

                <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                    <button id="export-data-btn" class="form-btn-save" style="flex: 1;">
                        <i class="fa-solid fa-download"></i> Export
                    </button>

                    <input type="file" id="import-file-input" accept=".json" style="display: none;">
                    <button id="import-data-btn" class="form-btn-cancel" style="flex: 1;">
                        <i class="fa-solid fa-upload"></i> Import
                    </button>
                </div>
            </div>

            <div class="settings-section" style="margin-top: 1.5rem; border-top: 1px solid #444; padding-top: 1rem;">
                <h4>
                    <i class="fa-brands fa-github"></i> Cloud Sync (GitHub)
                    <i class="fa-solid fa-circle-question info-tooltip" data-tooltip="How to get a Token:
1. Log in to GitHub.com
2. Go to Settings > Developer Settings > Personal access tokens (classic)
3. Click 'Generate new token (classic)'
4. Check ONLY the 'gist' box
5. Generate & Copy the token here"></i>
                </h4>
                <p class="settings-desc">Auto-sync your data to a private GitHub Gist.</p>

                <!-- Initial Setup Button -->
                <button id="gh-setup-btn" class="form-btn-save"
                    style="width: 100%; background: #222; border: 1px solid #444; margin-bottom: 1rem;">
                    <i class="fa-solid fa-wrench"></i> Configure Cloud Sync
                </button>

                <!-- Configuration Area (Hidden by default) -->
                <div id="gh-config-area" style="display: none;">
                    <div class="input-group" style="margin-bottom: 1rem;">
                        <label style="display: block; margin-bottom: 0.5rem; font-size: 0.9rem; color: #ccc;">Personal
                            Access Token:</label>
                        <input type="password" id="github-token-input" placeholder="ghp_xxxxxxxxxxxx"
                            style="width: 100%; padding: 0.5rem; border-radius: 4px; border: 1px solid #444; background: #222; color: white;">
                    </div>

                    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                        <button id="gh-save-token-btn" class="form-btn-save"
                            style="flex: 1; background: #2ea44f;">Connect</button>
                    </div>
                </div>

                <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                    <!-- Sync Now button moved outside config area so it's accessible after connection -->
                    <button id="gh-manual-sync-btn" class="form-btn-save"
                        style="flex: 1; background: #1f6feb; display: none;" disabled>Sync Now</button>
                    <button id="gh-restore-btn" class="form-btn-save"
                        style="flex: 1; background: #d29922; display: none;" disabled>Restore </button>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                    <span style="color: #ccc; font-size: 0.9rem;">Auto-Sync</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="gh-autosync-toggle" disabled>
                        <span class="slider"></span>
                    </label>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem;">
                    <p id="gh-sync-status" style="font-size: 0.8rem; color: #888; font-style: italic; margin: 0;">
                        Status: Not connected</p>
                    <button id="gh-edit-token-btn"
                        style="background: none; border: none; color: #666; font-size: 0.8rem; cursor: pointer; text-decoration: underline; display: none;">Edit
                        Token</button>
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="form-btn-cancel" id="close-settings-modal">Close</button>
            </div>
        </div>
    </div>

    <div id="confirm-modal" class="modal-backdrop">
        <div class="modal-form" style="text-align: center; max-width: 350px;">
            <h3 id="confirm-title" style="margin-bottom: 1rem;">Are you sure?</h3>
            <p id="confirm-message" style="margin-bottom: 2rem; color: var(--text-secondary); line-height: 1.5;">
                Proceed?</p>
            <div class="form-actions" style="justify-content: center; gap: 1rem;">
                <button type="button" class="form-btn-cancel" id="confirm-cancel-btn">Cancel</button>
                <button type="button" class="form-btn-save" id="confirm-ok-btn"
                    style="background-color: var(--delete-color); color: white;">Confirm</button>
            </div>
        </div>
    </div>

    <div id="restore-modal" class="modal-backdrop">
        <div class="modal-form" style="text-align: center; max-width: 400px;">
            <h3 style="margin-bottom: 1rem;">Restore from Cloud?</h3>
            <p style="margin-bottom: 1.5rem; color: var(--text-secondary); line-height: 1.5;">
                This will <strong>overwrite</strong> your current local data with the backup from GitHub.
            </p>
            <div id="restore-stats"
                style="margin-bottom: 2rem; font-size: 0.9rem; color: var(--text-primary); background: var(--bg-secondary); padding: 1rem; border-radius: 8px; text-align: left; display: none;">
                <!-- Stats injected here -->
            </div>
            <div class="form-actions" style="justify-content: center; gap: 1rem;">
                <button type="button" class="form-btn-cancel" id="restore-cancel-btn">Cancel</button>
                <button type="button" class="form-btn-save" id="restore-confirm-btn"
                    style="background-color: #d29922; color: white;">Restore Data</button>
            </div>
        </div>
    </div>

    <!-- Secure Locker Modal -->
    <div id="locker-modal" class="modal-backdrop">
        <div class="modal-form"
            style="width: 100%; max-width: 500px; min-height: 300px; display: flex; flex-direction: column;">

            <!-- Close Button -->
            <button id="locker-close-btn"
                style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: #888; font-size: 1.2rem; cursor: pointer;">&times;</button>

            <!-- State 1: Auth (PIN Entry) -->
            <div id="locker-auth-view"
                style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; padding: 2rem;">
                <i class="fa-solid fa-vault"
                    style="font-size: 3rem; color: var(--accent-color); margin-bottom: 1.5rem;"></i>
                <h3 id="locker-auth-title" style="margin-bottom: 1rem;">Ghost Locker</h3>
                <p id="locker-auth-desc"
                    style="color: var(--text-secondary); margin-bottom: 1.5rem; text-align: center;">Enter Master PIN to
                    access cloud secrets.</p>

                <input type="password" id="locker-pin-input" placeholder="Enter PIN" maxlength="8"
                    style="font-size: 1.5rem; letter-spacing: 0.5rem; text-align: center; width: 200px; padding: 0.5rem; border-radius: 8px; border: 1px solid #444; background: #222; color: white; margin-bottom: 1rem;">

                <button id="locker-unlock-btn" class="form-btn-save" style="width: 200px;">Unlock</button>
                <p id="locker-error-msg" style="color: #ff4d4d; font-size: 0.8rem; margin-top: 1rem; height: 1rem;"></p>
            </div>

            <!-- State 2: Secrets List -->
            <div id="locker-list-view" style="display: none; flex-direction: column; flex: 1;">
                <h3 style="margin-bottom: 1rem; display: flex; align-items: center;">
                    <i class="fa-solid fa-user-secret" style="margin-right: 10px; color: var(--accent-color);"></i>
                    Secure Secrets
                </h3>

                <div id="locker-secrets-container"
                    style="flex: 1; overflow-y: auto; margin-bottom: 1rem; border: 1px solid #333; border-radius: 8px; padding: 0.5rem; min-height: 200px; max-height: 400px;">
                    <!-- Secrets injected here -->
                    <div style="text-align: center; color: #666; padding: 2rem;">No secrets found. Add one below.</div>
                </div>

                <!-- Add New Secret Form -->
                <div style="background: #222; padding: 1rem; border-radius: 8px; border: 1px solid #333;">
                    <h4 style="margin-bottom: 0.5rem; font-size: 0.9rem; color: #ccc;">Add New Secret</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <input type="text" id="new-secret-title" placeholder="Title (e.g. WiFi)"
                            style="padding: 0.4rem; background: #111; border: 1px solid #444; color: white; border-radius: 4px;">
                        <input type="text" id="new-secret-user" placeholder="Username (Optional)"
                            style="padding: 0.4rem; background: #111; border: 1px solid #444; color: white; border-radius: 4px;">
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="password" id="new-secret-pass" placeholder="Password / Secret"
                            style="flex: 1; padding: 0.4rem; background: #111; border: 1px solid #444; color: white; border-radius: 4px;">
                        <button id="locker-add-btn"
                            style="background: var(--accent-color); color: white; border: none; padding: 0 1rem; border-radius: 4px; cursor: pointer;">Add</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Session Unlock Modal (For Secure Token) -->
    <div id="session-unlock-modal" class="modal-backdrop" style="z-index: 2000;">
        <div class="modal-form"
            style="width: 100%; max-width: 400px; display: flex; flex-direction: column; align-items: center; padding: 2rem;">
            <i class="fa-solid fa-shield-halved" style="font-size: 3rem; color: #4dff88; margin-bottom: 1.5rem;"></i>
            <h3 style="margin-bottom: 1rem;">Unlock Session</h3>
            <p style="color: #ccc; margin-bottom: 1.5rem; text-align: center;">Enter your Master PIN to enable Cloud
                Sync.</p>

            <input type="password" id="session-pin-input" placeholder="Enter PIN" maxlength="8"
                style="font-size: 1.5rem; letter-spacing: 0.5rem; text-align: center; width: 200px; padding: 0.5rem; border-radius: 8px; border: 1px solid #444; background: #222; color: white; margin-bottom: 1.5rem;">

            <button id="session-unlock-btn" class="form-btn-save"
                style="width: 100%; background: #2ea44f; margin-bottom: 1rem;">Unlock</button>

            <button id="session-skip-btn"
                style="background: none; border: none; color: #666; font-size: 0.9rem; cursor: pointer; text-decoration: underline;">Skip
                (Stay Offline)</button>
            <p id="session-error-msg" style="color: #ff4d4d; font-size: 0.8rem; margin-top: 1rem; height: 1rem;"></p>
        </div>
    </div>

    <!-- Scripts (Order is important for Namespace Pattern) -->
    <script src="js/storage.js?v=2"></script>
    <script src="js/utils.js?v=2"></script>
    <script src="js/modules/crypto.js?v=1"></script>
    <script src="js/modules/clock.js?v=2"></script>
    <script src="js/modules/quote.js?v=2"></script>
    <script src="js/modules/links.js?v=2"></script>
    <script src="js/modules/bookmarks.js?v=2"></script>
    <script src="js/modules/search.js?v=2"></script>
    <script src="js/modules/notes.js?v=2"></script>
    <script src="js/modules/todo.js?v=2"></script>
    <script src="js/modules/background.js?v=3"></script>
    <script src="js/modules/ambient.js?v=2"></script>
    <script src="js/modules/calculator.js?v=2"></script>
    <script src="js/modules/sidebar.js?v=2"></script>
    <script src="js/modules/navbar.js?v=2"></script>
    <script src="js/modules/calendar.js?v=2"></script>
    <script src="js/modules/settings.js?v=2"></script>
    <script src="js/modules/githubSync.js?v=2"></script>
    <script src="js/modules/locker.js?v=1"></script>
    <script src="js/main.js?v=2"></script>

</body>

</html>